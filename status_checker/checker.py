import asyncio
import socket

from mcstatus import JavaServer

ips = """91.232.48.154:25565
185.89.64.105:25565
195.3.153.138:25565
195.238.227.173:25565
195.242.138.46:25565
195.246.216.10:25565
195.246.216.45:25565
195.246.216.64:25565
195.246.216.66:25565
195.246.216.69:25565
195.246.216.76:25565
195.246.216.77:25565
195.246.216.78:25565
195.246.216.72:25565
195.246.216.82:25565
195.246.216.85:25565
195.246.216.75:25565
195.246.216.86:25565
195.246.216.81:25565
195.246.216.84:25565
195.246.216.83:25565
195.246.216.97:25565
195.246.216.96:25565
195.246.216.101:25565
195.246.216.103:25565
195.246.216.100:25565
195.246.216.99:25565
195.246.216.104:25565
195.246.216.95:25565
195.246.216.98:25565
195.246.216.102:25565
195.246.216.105:25565
195.246.216.128:25565
195.246.216.130:25565
195.246.216.131:25565
195.246.216.129:25565
195.246.216.193:25565
195.246.216.203:25565
195.246.216.194:25565
195.246.216.206:25565
195.246.216.204:25565
195.246.216.205:25565
195.246.216.216:25565
195.246.216.211:25565
195.246.216.212:25565
195.246.216.226:25565
195.246.216.225:25565
195.246.216.227:25565
195.246.216.220:25565
195.246.216.228:25565
195.246.216.229:25565
195.246.216.232:25565
195.246.216.230:25565
195.246.216.234:25565
195.246.216.235:25565
195.246.216.236:25565
195.246.216.237:25565
195.246.216.238:25565
195.246.216.239:25565
195.246.216.245:25565
193.42.241.33:25565
193.42.242.6:25565
193.42.242.52:25565
"""


async def check(address=None, ip=None, port=None):
    try:
        server = await JavaServer.async_lookup(address or f'{ip}:{port}', timeout=1)
        print(f'{address} {server.status().raw}')
        with open('good.txt', 'a') as file:
            file.write(f'{address} {server.status().raw}\n')
    except socket.timeout:
        print("timeout")
    except OSError:
        print('Pizda OSError')


loop = asyncio.get_event_loop()
tasks = []
for ip in ips.split('\n'):
    tasks.append(loop.create_task(check(ip)))
asyncio.gather(*tasks)
loop.run_forever()
